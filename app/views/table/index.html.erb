<% content_for :head do %>
  <%= stylesheet_link_tag :table %>
  <%= javascript_include_tag 'jquery.caret.1.02' %>
  <%= javascript_include_tag :table %>
  <script type="text/javascript">
    var sChangesTextAjaxUrl = "<%= cell_change_path %>";
    var sUpdateTextAjaxUrl = "<%= cell_index_path(:js) %>";
  </script>
<% end %>


<table border="1" data-time="<%= @updated_at.to_i %>">
  <% @rows.times do |r| %>
    <tr>
    <% @columns.times do |c| %>
       <td>
         <div class="highlight-pane">
          <div class="highlight search-highlight" style="left: 2px; top: 2px; width: 41px; height: 17px;"></div>
         </div>
         <% current_index = "r#{r}c#{c}" %>
         <% text = @cell_index[current_index].nil? ? 
                     nil : 
                     @cell_index[current_index][0].text %>
         <%= text_field_tag "cell[text]", text, 
                            id: "r#{r}c#{c}", class: "text" %>       
       </td>
    <% end %>
    </tr>
  <% end %>
</table> 
